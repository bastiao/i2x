<% content_for :title, "Editing #{@integration.title} - #{Settings.app.title}" %>
<ul class="breadcrumbs">
  <li><a href="/">Home</a></li>
  <li><%= link_to 'Dashboard', integrations_path %></li>
  <li><%= link_to @integration.title, @integration %></li>
  <li class="current">Edit
    <%= @integration.title %></li>
</ul>
<h1 id="integration" data-id="<%= @integration.id %>">Editing
  <strong><%= @integration.title %></strong></h1>
<%= render 'form' %>
<!-- Agents -->
<div class="row">
  <div class="small-12 medium-2 large-2 columns">
    <h3><%= pluralize(@integration.agent.size, 'Agent') %></h3>
  </div>
  <div class="small-12 medium-10 large-10 columns">
    <% @integration.agent.each do |agent| %>
      <div class="row">
        <div class="small-12 medium-12 large-12 columns"><h4 class="subheader"><%= link_to agent.title, agent %></h4></div>
        <div class="small-12 medium-8 large-8 columns left">
          <span class="label secondary radius"><small>
              Last check
              <%= time_ago_in_words(agent.last_check_at) %>
              ago</small></span>
          <span class="label secondary radius"><i class="icon-level-up"></i><%= agent.publisher %></span>
          <span class="label secondary radius"><i class="icon-back-in-time"></i><%= agent.schedule %></span>
          <%= (agent.seed.size != 0) ? "<span class=\"label radius\">#{pluralize(agent.seed.size, 'seed')}</span>".html_safe : '' %>
        </div>
        <div class="small-12 medium-4 large-4 columns right">
          <%= link_to 'Remove', agent, :class => 'remove right', method: :delete, data: { confirm: "Are you sure you want to remove the #{agent.title} agent?" } %>
        </div>
      </div>
    <% end %>
    <br />
    <div class="row" id="select_agent" style="display: none;">
      <div class="small-3 medium-3 large-3 columns">
        <label class="right inline">Select agent</label>
      </div>
      <div class="small-9 medium-9 large-9 columns">
        <select id="agent_select_list" tabindex="8">
          <option value="0" selected="selected">Create new agent...</option>
          <% @agents.each do |agent| %>
            <option value="<%= agent.id %>"><%= agent.title %></option>
          <% end %>
        </select>
      </div>
      <div class="small-12 medium-12 large-12 columns" >
        <div class="row">
          <div class="small-2 columns right">
            <a href="#" id="edit_save_new_agent_button" class="button tiny success radius right">Add agent</a>
          </div>
        </div>
      </div>
    </div>
    <div class="row" id="edit_add_button_row">
      <div class="small-12 medium-12 large-12 columns" >
        <div class="row">
          <div class="small-2 columns right">
            <a href="#" id="edit_add_new_agent_button" class="button tiny success radius right">Add new agent</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Templates -->
  <div class="row">
    <div class="small-12 medium-2 large-2 columns">
      <h3><%= pluralize(@integration.template.size, 'Template') %></h3>
    </div>
    <div class="small-12 medium-10 large-10 columns">
      <% @integration.template.each do |template| %>
        <div class="row">
          <div class="small-12 medium-12 large-12 columns"><h4 class="subheader"><%= link_to template.title, template %></h4></div>
          <div class="small-12 medium-8 large-8 columns left">
            <span class="label secondary radius"><i class="icon-level-up"></i><%= template.publisher %></span>
          </div>
          <div class="small-12 medium-4 large-4 columns right">
            <%= link_to 'Remove', template, :class => 'remove right', method: :delete, data: { confirm: "Are you sure you want to remove the #{template.title} template?" } %>
          </div>
        </div>
      <% end %>
      <div class="row">
        <br />
        <div class="small-12 medium-3 large-3 columns right">
          <a href="#" class="button success tiny radius right" id="add_new_template">Add new template</a>
        </div>
      </div>
    </div>
  </div>
  <br />
  <div class="row">
    <div class="small-1 columns right">
      <%= link_to 'Remove', @integration, :class => 'remove right', method: :delete, data: { confirm: "Are you sure you want to remove the #{@integration.title} integration?" } %>
    </div>
  </div>
